<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ChatApp - Real Time Chat</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.1/stomp.min.js"></script>
</head>

<body class="bg-light">

<div class="container d-flex justify-content-center mt-5">
    <div class="card shadow-lg" style="width: 100%; max-width: 800px;">

        <!-- Header -->
        <div class="card-header bg-primary text-white text-center">
            <h4 class="mb-0">ðŸ’¬ Real-Time Chat Application</h4>
        </div>

        <!-- Chat Window -->
        <div id="chat"
             class="card-body overflow-auto"
             style="height: 450px;width: 800px;  background-color: #f8f9fa;">
        </div>

        <!-- Sender Input -->
        <div class="card-footer bg-white">
            <div class="mb-2">
                <input id="senderInput"
                       type="text"
                       class="form-control"
                       placeholder="Enter your name...">
            </div>

            <!-- Message Input -->
            <div class="input-group">
                <input id="messageInput"
                       type="text"
                       class="form-control"
                       placeholder="Type a message...">

                <button id="sendMessage"
                        class="btn btn-primary px-4">
                    Send
                </button>
            </div>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

<script>
    var stompClient = null;

    function setConnected(connected) {
        document.getElementById('sendMessage').disabled = !connected;
    }

    function connect() {
        var socket = new SockJS('/chat');
        stompClient = Stomp.over(socket);

        stompClient.connect({}, function () {
            setConnected(true);

            stompClient.subscribe('/topic/messages', function (message) {
                showMessage(JSON.parse(message.body));
            });
        });
    }

    function showMessage(message) {
        var chat = document.getElementById('chat');

        var messageWrapper = document.createElement('div');
        messageWrapper.className = "mb-3";

        var messageBubble = document.createElement('div');
        messageBubble.className = "p-3 rounded w-full bg-white shadow-sm";

        messageBubble.innerHTML =
            "<strong>" + message.sender + ":</strong><br>" +
            "<span>" + message.content + "</span>";

        messageWrapper.appendChild(messageBubble);
        chat.appendChild(messageWrapper);

        chat.scrollTop = chat.scrollHeight;
    }

    function sendMessage() {
        var sender = document.getElementById('senderInput').value;
        var content = document.getElementById('messageInput').value;

        if (!sender || !content) return;

        var chatMessage = {
            sender: sender,
            content: content
        };

        stompClient.send("/app/sendMessage", {}, JSON.stringify(chatMessage));
        document.getElementById('messageInput').value = "";
    }

    document.getElementById('sendMessage').onclick = sendMessage;
    window.onload = connect;
</script>

</body>
</html>
